# My Ultracube blog: Part 1
Ultracube is an extremely unique mod. It brings in a lot of design challenges that are not seen in base factorio; or it enlarges small problems you might encounter in vanilla and make them require a dedicated solution. 

I will present to you the problems I have encountered in my playthrough. I will break this into multiple parts, and each chapter will be about the problems in a specific science. 

For some background, I need you to know the most distinct feature of ultracube: you have one unique cube, which can be used to make things, and you need to manage where the cube goes in your factory to make as much things as possible.

Here is my general strategy: research one science, then completely stop, and fully automate the next science before I researched. My subgoal here is to make each of these steps as high spm as I could. When I finish the last science, I will try to build a final base. 

This allows me to focus on designing, without worrying about constantly obtaining new recipes and having to update my factory. This is a general problem you will see in ultracube:

### PROBLEM I: alternative recipes
You will often get new recipes that either simplifies or complicates your existing build, and if you build to tightly, there will be no space to expand, and as we will see, you want a lot of buildings close to each other in a centralized location. This creates a design challenge. As I mentioned before, my solution is simply to research as much as I can, then completely stop, and build a new base using the new techs I have obtained. 
The downside to this approach is of course having to rebuild the base after each science. But I think due to the expandability constraints, rebuilding will be necessary, so why not do it in a more deterministic way? 
Another downside is that you could be missing some recipes that are much more effective. For example, I automated my level 2 science without using a better recipe for metal, which I could have unlocked if I just made some level 2 cards and then did some quick research. Consequently, I drained my starting ore patch before even finishing researching all level 2 techs. But I believe the waste here will be nothing in the grand scale, and the starting ore patch is so small anyway I did not care about it lasting for too long.
Now let us get in to the builds for each level of science.

## SCIENCE 1: GREY CARD
For the first science, you have no inserters, so there is no way to automate anything. All you can do is to manually insert the cube to a boiler and make some steam, then insert into a synthesizer and make some grey cards, then do research all with manual insertion. So nothing interesting here.

## SCIENCE 2: GREEN CARD
This is where the challenge begins. There are two parts of the factory: The part that require the cube to function, and the stone/brick factory. The stone part is only used for making machines and not for science. The amount of machines that you need to automate the green card is very small, so I hand crafted all of them and did not have a mall. So I was able to keep the stone factory completely separate.
Now to the interesting part: the factory that needs the cube to run. This involves five recipes: Power i.e. steam production, white plastic things, metal refining, level 1 card, and gear plate things.
For the layout of these parts, we encounter the next problem.

### PROBLEM II: cube travel time.
There is a notion of cube utilization: what percentage of the time is the cube being used to create something? The longer your cube is in a factory making things, the more efficient your factory is. Conversely, if the cube is on a belt traveling to a machine that wants it, then that time is wasted because it is not being used to create anything. Therefore, the longer the travel time is, the lower your cube utilization is.
I do not think this is much of an issue unless you want to reach the maximum SPM possible theoretically. Because even if the travel time is long, the cube utilization can be improved by: BUFFERS. 
Consider the following situation, the cube travels from factory A to factory B in 10 seconds. It stays in factory B for 10 seconds and moves on. In this case we have 50% of the cubeâ€™s time being used while the other 50% is spent on travel. However, if we let it stay in factory B for 30 seconds, then this part would have a cube utilization of 75%. Now imagine if you let the cube stay in factory B for an hour, or a year. Then cube utilization will be as close to 100% as possible. 
The constraint here for us is the buffer amount: we need to set up enough chests to receive the output of the cube so that it can stay in factory B for a long time. Of course we also want the cube to move on, because otherwise if it stays for too long in each section, then it will take forever for it to get to actually making the science. Therefore you have two options to increase cube utilization here: increase buffer, or lower travel time.
In the case of green card, again, since we only have 5 things that require the cube, we can make them extremely centralized and have the cube being directly inserted from machines to machines, with minimal travel time. This allows us to not build as big a buffer to reach a high cube utilization, at the cost of the factory being ugly.
So this is the theory, but when you start building the machines, you will find a new problem.

### PROBLEM III: output speed
The cube is extremely powerful and can create a great amount of items in a short amount of time. If it creates 1000 plastic bars within one second, then we can not take them out using inserters, within a second, even if we surround the machine with inserters. This is by design, to account for the cube not being able to accommodate every machine at once. So if we need 10 plastic bars per second for science, then we can run the machine for 1 second and get 1000 bars, and have it be idle for the other 99 seconds.
The machine will not run if there is too much output stuck inside its internal buffer, and the solution is to have multiple copies of the machine, and have the other copies be running when the first copy is having its content taken out by inserters. The number of copies you need is given by the rate of creation divided by the rate of extraction. If you have one inserter taking out 1 bar at a time and a machine that creates 10 bar per second, then you would need about 10 machines. The more precise ratio should also account for the travel time of the cube between machines.
Now that you have built up a buffer and the cube moved on to the other part of the factory, your buffer will be slowly used up and the factory will require the cube again. However, in practice you might notice that the buffer runs out unevenly, and eventually this can cause an imbalance, and the inserters will not operate at maximal efficiency. For example, if you have 3 buffer chest and the two on the sides run out before the middle one, then over time, you will have almost empty side chests and almost full middle chests, and when outputting from machine to chest, only the side ones would work. Or when you output from chest to belt, only the middle one would work. This is our next problem.

### PROBLEM IV: unbalanced unloading
You need to make sure all chests are being used at the same rate. This requires the use of an input-balanced balancer. So keep this in mind if you find your buffers are being drained in a weird fashion.
Back to the system of how to manage where the cube goes. One could simply let the factory send a signal when its buffer goes below a threshold and request the cube. However, you might find, say the cube goes to the factory of gear plates to build up a buffer, but it runs out of ingredients (metal) while doing so, and the cube is now stuck. Therefore we need a system that makes sure there is enough ingredients before sending the cube to somewhere else, but this requires a lot of computation, and a easier but not as efficient solution is the following.

### Problem V: cube priority
We use the same system of sending request signals, but now with a priority assigned to each factory. If the cube is in factory A but the buffer at factory B is too low, and the priority of B is higher than A, then we take out the cube from A and send it to B immediately. The priority for Green card from high to low is: steam, metal, plastic, grey card, green card.
With these problems solved, we have our final build for the green card factory. 


### Problem VI: idle power consumption
